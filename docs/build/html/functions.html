
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Functions &#8212; SIR-MIG  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=fd3f3429" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'functions';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Classes" href="classes.html" />
    <link rel="prev" title="Usage" href="usage.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">SIR-MIG  documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="usage.html">
                        Usage
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="#">
                        Functions
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="classes.html">
                        Classes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="plots.html">
                        Plotting
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="api.html">
                        API
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="usage.html">
                        Usage
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="#">
                        Functions
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="classes.html">
                        Classes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="plots.html">
                        Plotting
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="api.html">
                        API
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"></div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Functions</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="functions">
<h1>Functions<a class="headerlink" href="#functions" title="Link to this heading">#</a></h1>
<p>This list provides information for each function in each file.</p>
<section id="sir-py">
<h2>sir.py<a class="headerlink" href="#sir-py" title="Link to this heading">#</a></h2>
<p>Library for repeating functions such as reading the config, writing SIR files.</p>
<dl class="py function">
<dt class="sig sig-object py" id="sir.list_to_string">
<span class="sig-prename descclassname"><span class="pre">sir.</span></span><span class="sig-name descname"><span class="pre">list_to_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">let</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">','</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sir.list_to_string" title="Link to this definition">#</a></dt>
<dd><p>Convert a list to a string</p>
<section id="parameter">
<h3>Parameter<a class="headerlink" href="#parameter" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>temp<span class="classifier">list</span></dt><dd><p>List with the information which is converted into a string</p>
</dd>
<dt>let<span class="classifier">str</span></dt><dd><p>Letter which is added as a separation</p>
</dd>
</dl>
</section>
<section id="return">
<h3>Return<a class="headerlink" href="#return" title="Link to this heading">#</a></h3>
<p>string with the information from the list</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sir.option">
<span class="sig-prename descclassname"><span class="pre">sir.</span></span><span class="sig-name descname"><span class="pre">option</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sir.option" title="Link to this definition">#</a></dt>
<dd><p>Print an option in a help page</p>
<section id="id1">
<h3>Parameter<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>text1<span class="classifier">str</span></dt><dd><p>First text</p>
</dd>
<dt>text2<span class="classifier">str</span></dt><dd><p>Second text</p>
</dd>
</dl>
</section>
<section id="id2">
<h3>Return<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>None</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sir.read_chi2">
<span class="sig-prename descclassname"><span class="pre">sir.</span></span><span class="sig-name descname"><span class="pre">read_chi2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sir.read_chi2" title="Link to this definition">#</a></dt>
<dd><p>Reads the last chi value in a inv.chi file</p>
<section id="id3">
<h3>Parameter<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>filename<span class="classifier">string</span></dt><dd><p>Path of the chi file</p>
</dd>
<dt>task<span class="classifier">string, optional</span></dt><dd><p>Prints out in which folder the chi2 file does not exist. Default: ‘’</p>
</dd>
</dl>
</section>
<section id="id4">
<h3>Return<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>chi2<span class="classifier">float</span></dt><dd><p>Best chi2 value of the fit</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sir.read_chi2s">
<span class="sig-prename descclassname"><span class="pre">sir.</span></span><span class="sig-name descname"><span class="pre">read_chi2s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tasks</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sir.read_chi2s" title="Link to this definition">#</a></dt>
<dd><p>Reads all the chi2 from the inversion</p>
<section id="id5">
<h3>Parameter<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>config<span class="classifier">dict</span></dt><dd><p>Config parameters</p>
</dd>
<dt>tasks<span class="classifier">dict</span></dt><dd><p>Dictionary with the used folders</p>
</dd>
</dl>
</section>
<section id="id6">
<h3>Return<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>chi2<span class="classifier">numpy array</span></dt><dd><p>Numpy array with all chi2 values</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sir.read_grid">
<span class="sig-prename descclassname"><span class="pre">sir.</span></span><span class="sig-name descname"><span class="pre">read_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sir.read_grid" title="Link to this definition">#</a></dt>
<dd><p>Reads the grid file</p>
<section id="id7">
<h3>Parameter<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>filename<span class="classifier">string</span></dt><dd><p>File to be read</p>
</dd>
</dl>
</section>
<section id="id8">
<h3>Return<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>dict<span class="classifier">Dictionary</span></dt><dd><p>Dict. with ‘Line’, ‘min’, ‘step’ and ‘max’ in it</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sir.read_line">
<span class="sig-prename descclassname"><span class="pre">sir.</span></span><span class="sig-name descname"><span class="pre">read_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sir.read_line" title="Link to this definition">#</a></dt>
<dd><p>Reads the line file</p>
<section id="id9">
<h3>Parameter<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>filename<span class="classifier">string</span></dt><dd><p>File to be read</p>
</dd>
</dl>
</section>
<section id="id10">
<h3>Return<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>dict<span class="classifier">Dictionary</span></dt><dd><p>Dict. with ‘Line’, ‘Ion’, ‘wavelength’, ‘factor’, ‘Exc_Pot’, log_gf’,
‘Transition’, ‘alpha’ and ‘sigma’ in it</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sir.read_config">
<span class="sig-prename descclassname"><span class="pre">sir.</span></span><span class="sig-name descname"><span class="pre">read_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">change_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sir.read_config" title="Link to this definition">#</a></dt>
<dd><p>Reads a config file for the inversion</p>
<section id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>filename<span class="classifier">string</span></dt><dd><p>Path of the control file</p>
</dd>
<dt>check<span class="classifier">bool, optional</span></dt><dd><p>Check if file exists (Default: True)</p>
</dd>
<dt>change_config<span class="classifier">bool, optional</span></dt><dd><p>config file is read to be changed (=&gt; Do not try to load anything) (Default: False)</p>
</dd>
</dl>
</section>
<section id="returns">
<h3>Returns<a class="headerlink" href="#returns" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>Dict<span class="classifier">dict</span></dt><dd><p>Dict containing all the information from the config file</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sir.read_control">
<span class="sig-prename descclassname"><span class="pre">sir.</span></span><span class="sig-name descname"><span class="pre">read_control</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sir.read_control" title="Link to this definition">#</a></dt>
<dd><p>Reads a control file in the scheme SIR expects it.</p>
<section id="id11">
<h3>Parameter<a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>filename<span class="classifier">string</span></dt><dd><p>Path of the control file</p>
</dd>
</dl>
</section>
<section id="id12">
<h3>Return<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>Dict<span class="classifier">dict</span></dt><dd><p>Dict containing all the information from the control file</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sir.read_model">
<span class="sig-prename descclassname"><span class="pre">sir.</span></span><span class="sig-name descname"><span class="pre">read_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sir.read_model" title="Link to this definition">#</a></dt>
<dd><p>Reads a model file and returns all parameters</p>
<section id="id13">
<h3>Parameter<a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>filename<span class="classifier">string</span></dt><dd><p>String containing the path of the file</p>
</dd>
</dl>
</section>
<section id="id14">
<h3>Return<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>log_tau<span class="classifier">numpy.array</span></dt><dd><p>Log tau</p>
</dd>
<dt>T<span class="classifier">numpy.array</span></dt><dd><p>Temperature in K</p>
</dd>
<dt>Pe<span class="classifier">numpy.array</span></dt><dd><p>Electron pressure in dyn/cm^2</p>
</dd>
<dt>v_micro<span class="classifier">numpy.array</span></dt><dd><p>Microturbulence velocity in cm/s</p>
</dd>
<dt>B<span class="classifier">numpy.array</span></dt><dd><p>Magnetic field strength in Gauss</p>
</dd>
<dt>vlos<span class="classifier">numpy.array</span></dt><dd><p>Line-of-sight velocity in cm/s</p>
</dd>
<dt>inc<span class="classifier">numpy.array</span></dt><dd><p>Inclination in deg</p>
</dd>
<dt>azimuth<span class="classifier">numpy.array</span></dt><dd><p>Azimuth angle in deg</p>
</dd>
<dt>z<span class="classifier">numpy.array, optional</span></dt><dd><p>Height in km</p>
</dd>
<dt>Pg<span class="classifier">numpy.array, optional</span></dt><dd><p>Gas pressure in dyn/cm^2</p>
</dd>
<dt>rho<span class="classifier">numpy.array, optional</span></dt><dd><p>Density in g/cm^3</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sir.read_profile">
<span class="sig-prename descclassname"><span class="pre">sir.</span></span><span class="sig-name descname"><span class="pre">read_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sir.read_profile" title="Link to this definition">#</a></dt>
<dd><p>Reads the first LINE data from a profile computed by SIR</p>
<section id="id15">
<h3>Parameter<a class="headerlink" href="#id15" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>filename<span class="classifier">string</span></dt><dd><p>String containing the path of the file</p>
</dd>
<dt>num<span class="classifier">int, optional</span></dt><dd><p>Number of the line which is loaded. Default: 0 (use first one from line)</p>
</dd>
</dl>
</section>
<section id="id16">
<h3>Return<a class="headerlink" href="#id16" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>ll<span class="classifier">numpy.array</span></dt><dd><p>Wavelengths in A</p>
</dd>
<dt>I<span class="classifier">numpy.array</span></dt><dd><p>Stokes I</p>
</dd>
<dt>Q<span class="classifier">numpy.array</span></dt><dd><p>Stokes Q</p>
</dd>
<dt>U<span class="classifier">numpy.array</span></dt><dd><p>Stokes U</p>
</dd>
<dt>V<span class="classifier">numpy.array </span></dt><dd><p>Stokes V</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sir.write_config_1c">
<span class="sig-prename descclassname"><span class="pre">sir.</span></span><span class="sig-name descname"><span class="pre">write_config_1c</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">File</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sir.write_config_1c" title="Link to this definition">#</a></dt>
<dd><p>Writes a config file with the information provided as a dictionary for the mode 1C</p>
<section id="id17">
<h3>Parameters<a class="headerlink" href="#id17" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>File<span class="classifier">string</span></dt><dd><p>Save path</p>
</dd>
<dt>conf<span class="classifier">dict</span></dt><dd><p>Dictionary with all the informations</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sir.write_config_2c">
<span class="sig-prename descclassname"><span class="pre">sir.</span></span><span class="sig-name descname"><span class="pre">write_config_2c</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">File</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sir.write_config_2c" title="Link to this definition">#</a></dt>
<dd><p>Writes a config file with the information provided as a dictionary</p>
<section id="id18">
<h3>Parameters<a class="headerlink" href="#id18" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>File<span class="classifier">string</span></dt><dd><p>Save path</p>
</dd>
<dt>conf<span class="classifier">dict</span></dt><dd><p>Dictionary with all the informations</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sir.write_config_mc">
<span class="sig-prename descclassname"><span class="pre">sir.</span></span><span class="sig-name descname"><span class="pre">write_config_mc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">File</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sir.write_config_mc" title="Link to this definition">#</a></dt>
<dd><p>Writes a config file with the information provided as a dictionary</p>
<section id="id19">
<h3>Parameters<a class="headerlink" href="#id19" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>File<span class="classifier">string</span></dt><dd><p>Save path</p>
</dd>
<dt>conf<span class="classifier">dict</span></dt><dd><p>Dictionary with all the informations</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sir.write_config">
<span class="sig-prename descclassname"><span class="pre">sir.</span></span><span class="sig-name descname"><span class="pre">write_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">File</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sir.write_config" title="Link to this definition">#</a></dt>
<dd><p>Writes a config file with the information provided as a dictionary for the mode 1C</p>
<section id="id20">
<h3>Parameters<a class="headerlink" href="#id20" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>File<span class="classifier">string</span></dt><dd><p>Save path</p>
</dd>
<dt>conf<span class="classifier">dict</span></dt><dd><p>Dictionary with all the informations</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sir.write_control_1c">
<span class="sig-prename descclassname"><span class="pre">sir.</span></span><span class="sig-name descname"><span class="pre">write_control_1c</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sir.write_control_1c" title="Link to this definition">#</a></dt>
<dd><p>Writes a control file in the scheme SIR expects it.</p>
<section id="id21">
<h3>Parameter<a class="headerlink" href="#id21" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>filename<span class="classifier">string</span></dt><dd><p>Save filename of the control file. Typically it is inv.trol</p>
</dd>
<dt>config<span class="classifier">dict</span></dt><dd><p>Dictionary with the information from the config file</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sir.write_control_2c">
<span class="sig-prename descclassname"><span class="pre">sir.</span></span><span class="sig-name descname"><span class="pre">write_control_2c</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sir.write_control_2c" title="Link to this definition">#</a></dt>
<dd><p>Writes a control file in the scheme SIR expects it.</p>
<section id="id22">
<h3>Parameter<a class="headerlink" href="#id22" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>filename<span class="classifier">string</span></dt><dd><p>Save filename of the control file. Typically it is inv.trol</p>
</dd>
<dt>conf<span class="classifier">dict</span></dt><dd><p>Dictionary with the information from the config file</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sir.write_control_mc">
<span class="sig-prename descclassname"><span class="pre">sir.</span></span><span class="sig-name descname"><span class="pre">write_control_mc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'inv'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sir.write_control_mc" title="Link to this definition">#</a></dt>
<dd><p>Writes a control file in the scheme SIR expects it.</p>
<section id="id23">
<h3>Parameter<a class="headerlink" href="#id23" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>filename<span class="classifier">string</span></dt><dd><p>Save filename of the control file. Typically it is inv.trol</p>
</dd>
<dt>config<span class="classifier">dict</span></dt><dd><p>Dictionary with the information from the config file</p>
</dd>
<dt>Type<span class="classifier">string</span></dt><dd><p>which type of control file is created (‘syn’ for synthesis, ‘inv’ for inversion)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sir.write_grid">
<span class="sig-prename descclassname"><span class="pre">sir.</span></span><span class="sig-name descname"><span class="pre">write_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">waves</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Grid.grid'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sir.write_grid" title="Link to this definition">#</a></dt>
<dd><p>Writes the Grid file with data from the config file</p>
<section id="id24">
<h3>Parameter<a class="headerlink" href="#id24" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>config<span class="classifier">dict</span></dt><dd><p>Dictionary containing all the information from the config file</p>
</dd>
<dt>filename<span class="classifier">string, optional</span></dt><dd><p>String containing the name of the Grid file. Default: Grid.grid</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sir.write_grid_mc">
<span class="sig-prename descclassname"><span class="pre">sir.</span></span><span class="sig-name descname"><span class="pre">write_grid_mc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Grid.grid'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sir.write_grid_mc" title="Link to this definition">#</a></dt>
<dd><p>Writes the Grid file with data from the config file</p>
<section id="id25">
<h3>Parameter<a class="headerlink" href="#id25" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>config<span class="classifier">dict</span></dt><dd><p>Dictionary containing all the information from the config file</p>
</dd>
<dt>filename<span class="classifier">string, optional</span></dt><dd><p>String containing the name of the Grid file. Default: Grid.grid</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sir.write_model">
<span class="sig-prename descclassname"><span class="pre">sir.</span></span><span class="sig-name descname"><span class="pre">write_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Header</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_micro</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">azimuth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sir.write_model" title="Link to this definition">#</a></dt>
<dd><p>Write a model with the given data in a specific format. Note that negative values
have one white space less</p>
<section id="id26">
<h3>Parameter<a class="headerlink" href="#id26" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>filename<span class="classifier">string</span></dt><dd><p>Name of the saved file</p>
</dd>
<dt>Header<span class="classifier">string</span></dt><dd><p>Header of the model</p>
</dd>
<dt>log_tau<span class="classifier">numpy.array</span></dt><dd><p>Log tau</p>
</dd>
<dt>T<span class="classifier">numpy.array</span></dt><dd><p>Temperature in K</p>
</dd>
<dt>Pe<span class="classifier">numpy.array</span></dt><dd><p>Electron pressure in dyn/cm^2</p>
</dd>
<dt>v_micro<span class="classifier">numpy.array</span></dt><dd><p>Microturbulence velocity in cm/s</p>
</dd>
<dt>B<span class="classifier">numpy.array</span></dt><dd><p>Magnetic field strength in Gauss</p>
</dd>
<dt>vlos<span class="classifier">numpy.array</span></dt><dd><p>Line-of-sight velocity in cm/s</p>
</dd>
<dt>inc<span class="classifier">numpy.array</span></dt><dd><p>Inclination in deg</p>
</dd>
<dt>azimuth<span class="classifier">numpy.array</span></dt><dd><p>Azimuth angle in deg</p>
</dd>
<dt>z<span class="classifier">numpy.array, optional</span></dt><dd><p>Height in km</p>
</dd>
<dt>Pg<span class="classifier">numpy.array, optional</span></dt><dd><p>Gas pressure in dyn/cm^2</p>
</dd>
<dt>rho<span class="classifier">numpy.array, optional</span></dt><dd><p>Density in g/cm^3</p>
</dd>
</dl>
</section>
<section id="id27">
<h3>Return<a class="headerlink" href="#id27" title="Link to this heading">#</a></h3>
<p>None</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sir.write_profile">
<span class="sig-prename descclassname"><span class="pre">sir.</span></span><span class="sig-name descname"><span class="pre">write_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">profiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sir.write_profile" title="Link to this definition">#</a></dt>
<dd><p>Write a profile for a specific model number to a file</p>
<section id="id28">
<h3>Parameter<a class="headerlink" href="#id28" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>filename<span class="classifier">string</span></dt><dd><p>Name of the saved file</p>
</dd>
<dt>profiles<span class="classifier">list</span></dt><dd><p>List containing all the profiles</p>
</dd>
<dt>atoms<span class="classifier">list</span></dt><dd><p>List containing the number of the line from the Line file</p>
</dd>
<dt>pos<span class="classifier">int</span></dt><dd><p>Position which model is saved</p>
</dd>
</dl>
</section>
<section id="id29">
<h3>Return<a class="headerlink" href="#id29" title="Link to this heading">#</a></h3>
<p>None</p>
</section>
</dd></dl>

</section>
<section id="create-config-py">
<h2>create_config.py<a class="headerlink" href="#create-config-py" title="Link to this heading">#</a></h2>
<p>Functions to create the config files for the different modes.</p>
<dl class="py function">
<dt class="sig sig-object py" id="create_config.config_MC">
<span class="sig-prename descclassname"><span class="pre">create_config.</span></span><span class="sig-name descname"><span class="pre">config_MC</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#create_config.config_MC" title="Link to this definition">#</a></dt>
<dd><p>Creates a config file for the Monte-Carlo simulation by asking questions.</p>
<section id="id30">
<h3>Parameters<a class="headerlink" href="#id30" title="Link to this heading">#</a></h3>
<p>None</p>
</section>
<section id="id31">
<h3>Returns<a class="headerlink" href="#id31" title="Link to this heading">#</a></h3>
<p>None</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="create_config.config_1C">
<span class="sig-prename descclassname"><span class="pre">create_config.</span></span><span class="sig-name descname"><span class="pre">config_1C</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#create_config.config_1C" title="Link to this definition">#</a></dt>
<dd><p>Creates a config file for the 1 Component Inversion by asking questions.</p>
<section id="id32">
<h3>Parameters<a class="headerlink" href="#id32" title="Link to this heading">#</a></h3>
<p>None</p>
</section>
<section id="id33">
<h3>Returns<a class="headerlink" href="#id33" title="Link to this heading">#</a></h3>
<p>None</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="create_config.config_2C">
<span class="sig-prename descclassname"><span class="pre">create_config.</span></span><span class="sig-name descname"><span class="pre">config_2C</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#create_config.config_2C" title="Link to this definition">#</a></dt>
<dd><p>Creates a config file for the 2 Components Inversion by asking questions.</p>
<section id="id34">
<h3>Parameters<a class="headerlink" href="#id34" title="Link to this heading">#</a></h3>
<p>None</p>
</section>
<section id="id35">
<h3>Returns<a class="headerlink" href="#id35" title="Link to this heading">#</a></h3>
<p>None</p>
</section>
</dd></dl>

</section>
<section id="create-profiles">
<h2>create_profiles<a class="headerlink" href="#create-profiles" title="Link to this heading">#</a></h2>
<p>Function to create profiles with synthesis and adding noise
.. autofunction:: create_profiles.add_noise
.. autofunction:: create_profiles.synthesis</p>
</section>
<section id="inversion-py">
<h2>inversion.py<a class="headerlink" href="#inversion-py" title="Link to this heading">#</a></h2>
<p>Functions to perform the inversion</p>
<dl class="py function">
<dt class="sig sig-object py" id="inversion.execute_inversion_1c">
<span class="sig-prename descclassname"><span class="pre">inversion.</span></span><span class="sig-name descname"><span class="pre">execute_inversion_1c</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#inversion.execute_inversion_1c" title="Link to this definition">#</a></dt>
<dd><p>Executes inversion and creates if needed random guesses. Make sure that
when this function is entered, the os is in the right directory! This
function can be used for the mode ‘MC’ and ‘1C’.</p>
<section id="id36">
<h3>Parameters<a class="headerlink" href="#id36" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>config<span class="classifier">dict</span></dt><dd><p>Dictionary containing the configuration of the simulation</p>
</dd>
<dt>task_folder<span class="classifier">dict</span></dt><dd><p>Dictionary with the folders and x and y positions</p>
</dd>
<dt>rank<span class="classifier">int</span></dt><dd><p>Process Number</p>
</dd>
</dl>
</section>
<section id="id37">
<h3>Returns<a class="headerlink" href="#id37" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>chi2<span class="classifier">float</span></dt><dd><p>Best chi2 value of the inversion(s)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="inversion.execute_inversion_2c">
<span class="sig-prename descclassname"><span class="pre">inversion.</span></span><span class="sig-name descname"><span class="pre">execute_inversion_2c</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#inversion.execute_inversion_2c" title="Link to this definition">#</a></dt>
<dd><p>Executes inversion and creates if needed random guesses. Make sure that
when this function is entered, the os is in the right directory! This is
used for the mode ‘2C’.</p>
<section id="id38">
<h3>Parameter<a class="headerlink" href="#id38" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>conf<span class="classifier">Dictionary</span></dt><dd><p>Dictionary containing the configuration of the simulation</p>
</dd>
<dt>task_folder<span class="classifier">dict</span></dt><dd><p>Dictionary with the folders and x and y positions</p>
</dd>
<dt>rank<span class="classifier">int</span></dt><dd><p>Process Number</p>
</dd>
</dl>
</section>
<section id="id39">
<h3>Return<a class="headerlink" href="#id39" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>chi2<span class="classifier">float</span></dt><dd><p>Best chi2 value of the inversion(s)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="inversion.inversion_1c">
<span class="sig-prename descclassname"><span class="pre">inversion.</span></span><span class="sig-name descname"><span class="pre">inversion_1c</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MPI</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#inversion.inversion_1c" title="Link to this definition">#</a></dt>
<dd><p>Performs the inversion of all the models.</p>
<section id="id40">
<h3>Parameter<a class="headerlink" href="#id40" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>config<span class="classifier">dict</span></dt><dd><p>Dictionary with all information from the config file</p>
</dd>
<dt>comm, rank, size, MPI<span class="classifier">MPI variables</span></dt><dd><dl class="simple">
<dt>Variables defined as</dt><dd><ul class="simple">
<li><p>comm = MPI.COMM_WORLD</p></li>
<li><p>rank = comm.Get_rank()</p></li>
<li><p>size = comm.Get_size()</p></li>
<li><p>MPI = MPI library imported as from mpi4py import MPI</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</section>
<section id="id41">
<h3>Return<a class="headerlink" href="#id41" title="Link to this heading">#</a></h3>
<p>None</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="inversion.inversion_2c">
<span class="sig-prename descclassname"><span class="pre">inversion.</span></span><span class="sig-name descname"><span class="pre">inversion_2c</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MPI</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#inversion.inversion_2c" title="Link to this definition">#</a></dt>
<dd><p>Performs the inversion of all the models.</p>
<section id="id42">
<h3>Parameter<a class="headerlink" href="#id42" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>conf<span class="classifier">dict</span></dt><dd><p>Dictionary with all information from the config file</p>
</dd>
<dt>comm, rank, size<span class="classifier">MPI variables</span></dt><dd><dl class="simple">
<dt>Variables defined as</dt><dd><ul class="simple">
<li><p>comm = MPI.COMM_WORLD</p></li>
<li><p>rank = comm.Get_rank()</p></li>
<li><p>size = comm.Get_size()</p></li>
<li><p>MPI = MPI library imported as from mpi4py import MPI</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</section>
<section id="id43">
<h3>Return<a class="headerlink" href="#id43" title="Link to this heading">#</a></h3>
<p>None</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="inversion.inversion_mc">
<span class="sig-prename descclassname"><span class="pre">inversion.</span></span><span class="sig-name descname"><span class="pre">inversion_mc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MPI</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#inversion.inversion_mc" title="Link to this definition">#</a></dt>
<dd><p>Performs the inversion of all the models.</p>
<section id="id44">
<h3>Parameter<a class="headerlink" href="#id44" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>conf<span class="classifier">dict</span></dt><dd><p>Dictionary with all information from the config file</p>
</dd>
<dt>comm, rank, size, MPI<span class="classifier">MPI variables</span></dt><dd><dl class="simple">
<dt>Variables defined as</dt><dd><ul class="simple">
<li><p>comm = MPI.COMM_WORLD</p></li>
<li><p>rank = comm.Get_rank()</p></li>
<li><p>size = comm.Get_size()</p></li>
<li><p>MPI = MPI library imported as from mpi4py import MPI</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</section>
<section id="id45">
<h3>Return<a class="headerlink" href="#id45" title="Link to this heading">#</a></h3>
<p>None</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="inversion.scatter_data">
<span class="sig-prename descclassname"><span class="pre">inversion.</span></span><span class="sig-name descname"><span class="pre">scatter_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#inversion.scatter_data" title="Link to this definition">#</a></dt>
<dd><p>Scatters the data equally into all the ranks</p>
<section id="id46">
<h3>Parameter<a class="headerlink" href="#id46" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>conf<span class="classifier">Dict</span></dt><dd><p>Config information</p>
</dd>
<dt>path<span class="classifier">string</span></dt><dd><p>Path where we are</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="inversion.scatter_data_mc">
<span class="sig-prename descclassname"><span class="pre">inversion.</span></span><span class="sig-name descname"><span class="pre">scatter_data_mc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#inversion.scatter_data_mc" title="Link to this definition">#</a></dt>
<dd><p>Scatters the data equally into all the ranks for the MC simulation</p>
<section id="id47">
<h3>Parameter<a class="headerlink" href="#id47" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>conf<span class="classifier">Dict</span></dt><dd><p>Config information</p>
</dd>
<dt>path<span class="classifier">string</span></dt><dd><p>Path where we are</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="main-py">
<h2>main.py<a class="headerlink" href="#main-py" title="Link to this heading">#</a></h2>
<p>Main file to start the program</p>
<dl class="py function">
<dt class="sig sig-object py" id="main.main">
<span class="sig-prename descclassname"><span class="pre">main.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#main.main" title="Link to this definition">#</a></dt>
<dd><p>Function which executes the programme</p>
<section id="id48">
<h3>Parameters<a class="headerlink" href="#id48" title="Link to this heading">#</a></h3>
<p>None</p>
</section>
<section id="id49">
<h3>Returns<a class="headerlink" href="#id49" title="Link to this heading">#</a></h3>
<p>None</p>
</section>
</dd></dl>

</section>
<section id="model-py">
<h2>model.py<a class="headerlink" href="#model-py" title="Link to this heading">#</a></h2>
<p>Function to read a binary model file with all the physical parameter</p>
<dl class="py function">
<dt class="sig sig-object py" id="model.read_model">
<span class="sig-prename descclassname"><span class="pre">model.</span></span><span class="sig-name descname"><span class="pre">read_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.read_model" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="misc-py">
<h2>misc.py<a class="headerlink" href="#misc-py" title="Link to this heading">#</a></h2>
<p>Miscellaneous functions</p>
<dl class="py function">
<dt class="sig sig-object py" id="misc.create_task_folder_list">
<span class="sig-prename descclassname"><span class="pre">misc.</span></span><span class="sig-name descname"><span class="pre">create_task_folder_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#misc.create_task_folder_list" title="Link to this definition">#</a></dt>
<dd><p>Creates a list which folders should be created and executed. This is done so
that the inversion itself can be executed linearly to make use of all cores.</p>
<section id="id50">
<h3>Parameter<a class="headerlink" href="#id50" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>arg<span class="classifier">numpy array or int</span></dt><dd><p>1x4 array containing the limits in x and y of the data or number of 1D models</p>
</dd>
</dl>
</section>
<section id="id51">
<h3>Return<a class="headerlink" href="#id51" title="Link to this heading">#</a></h3>
<p>Dictionary with all the names of the task folders, x and y position</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="misc.initial">
<span class="sig-prename descclassname"><span class="pre">misc.</span></span><span class="sig-name descname"><span class="pre">initial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#misc.initial" title="Link to this definition">#</a></dt>
<dd><p>Initial print outs and preparation</p>
<section id="id52">
<h3>Parameter<a class="headerlink" href="#id52" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>mode<span class="classifier">string</span></dt><dd><p>Mode which is used</p>
</dd>
</dl>
</section>
<section id="id53">
<h3>Return<a class="headerlink" href="#id53" title="Link to this heading">#</a></h3>
<p>None</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="misc.x_y_add_zeros">
<span class="sig-prename descclassname"><span class="pre">misc.</span></span><span class="sig-name descname"><span class="pre">x_y_add_zeros</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#misc.x_y_add_zeros" title="Link to this definition">#</a></dt>
<dd><p>Adds zeros so that the returning strings have 4 letters</p>
<section id="id54">
<h3>Parameter<a class="headerlink" href="#id54" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>x<span class="classifier">float</span></dt><dd><p>x position</p>
</dd>
<dt>y<span class="classifier">float</span></dt><dd><p>y position</p>
</dd>
</dl>
</section>
<section id="id55">
<h3>Return<a class="headerlink" href="#id55" title="Link to this heading">#</a></h3>
<p>x as a string of 4 letters
y as a string of 4 letters</p>
</section>
</dd></dl>

</section>
<section id="obs-py">
<h2>obs.py<a class="headerlink" href="#obs-py" title="Link to this heading">#</a></h2>
<p>Functions related to the observation</p>
<dl class="py function">
<dt class="sig sig-object py" id="obs.read_profile">
<span class="sig-prename descclassname"><span class="pre">obs.</span></span><span class="sig-name descname"><span class="pre">read_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">profile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">waves</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#obs.read_profile" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="obs.write_psf">
<span class="sig-prename descclassname"><span class="pre">obs.</span></span><span class="sig-name descname"><span class="pre">write_psf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#obs.write_psf" title="Link to this definition">#</a></dt>
<dd><p>Writes the spectral point spread function with the value from the spectral veil correction</p>
<section id="id56">
<h3>Parameter<a class="headerlink" href="#id56" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>config<span class="classifier">dict</span></dt><dd><p>Dictionary containing all the information of the config file</p>
</dd>
<dt>filename<span class="classifier">string</span></dt><dd><p>Filename under which the file is saved</p>
</dd>
</dl>
</section>
<section id="id57">
<h3>Return<a class="headerlink" href="#id57" title="Link to this heading">#</a></h3>
<p>None</p>
</section>
</dd></dl>

</section>
<section id="profile-stk-py">
<h2>profile_stk.py<a class="headerlink" href="#profile-stk-py" title="Link to this heading">#</a></h2>
<p>Function to read a binary profile file with the four Stokes Parameter</p>
<dl class="py function">
<dt class="sig sig-object py" id="profile_stk.read_profile">
<span class="sig-prename descclassname"><span class="pre">profile_stk.</span></span><span class="sig-name descname"><span class="pre">read_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#profile_stk.read_profile" title="Link to this definition">#</a></dt>
<dd><p>Reads a profile and returns a class</p>
<section id="id58">
<h3>Parameters<a class="headerlink" href="#id58" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>file<span class="classifier">str</span></dt><dd><p>String with the filename</p>
</dd>
</dl>
</section>
<section id="id59">
<h3>Returns<a class="headerlink" href="#id59" title="Link to this heading">#</a></h3>
<p>class Profile</p>
</section>
</dd></dl>

</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="usage.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Usage</p>
      </div>
    </a>
    <a class="right-next"
       href="classes.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Classes</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sir-py">sir.py</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sir.list_to_string"><code class="docutils literal notranslate"><span class="pre">list_to_string()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sir.option"><code class="docutils literal notranslate"><span class="pre">option()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sir.read_chi2"><code class="docutils literal notranslate"><span class="pre">read_chi2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sir.read_chi2s"><code class="docutils literal notranslate"><span class="pre">read_chi2s()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sir.read_grid"><code class="docutils literal notranslate"><span class="pre">read_grid()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sir.read_line"><code class="docutils literal notranslate"><span class="pre">read_line()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sir.read_config"><code class="docutils literal notranslate"><span class="pre">read_config()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sir.read_control"><code class="docutils literal notranslate"><span class="pre">read_control()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sir.read_model"><code class="docutils literal notranslate"><span class="pre">read_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sir.read_profile"><code class="docutils literal notranslate"><span class="pre">read_profile()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sir.write_config_1c"><code class="docutils literal notranslate"><span class="pre">write_config_1c()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sir.write_config_2c"><code class="docutils literal notranslate"><span class="pre">write_config_2c()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sir.write_config_mc"><code class="docutils literal notranslate"><span class="pre">write_config_mc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sir.write_config"><code class="docutils literal notranslate"><span class="pre">write_config()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sir.write_control_1c"><code class="docutils literal notranslate"><span class="pre">write_control_1c()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sir.write_control_2c"><code class="docutils literal notranslate"><span class="pre">write_control_2c()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sir.write_control_mc"><code class="docutils literal notranslate"><span class="pre">write_control_mc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sir.write_grid"><code class="docutils literal notranslate"><span class="pre">write_grid()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sir.write_grid_mc"><code class="docutils literal notranslate"><span class="pre">write_grid_mc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sir.write_model"><code class="docutils literal notranslate"><span class="pre">write_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sir.write_profile"><code class="docutils literal notranslate"><span class="pre">write_profile()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-config-py">create_config.py</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create_config.config_MC"><code class="docutils literal notranslate"><span class="pre">config_MC()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create_config.config_1C"><code class="docutils literal notranslate"><span class="pre">config_1C()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create_config.config_2C"><code class="docutils literal notranslate"><span class="pre">config_2C()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-profiles">create_profiles</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inversion-py">inversion.py</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inversion.execute_inversion_1c"><code class="docutils literal notranslate"><span class="pre">execute_inversion_1c()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inversion.execute_inversion_2c"><code class="docutils literal notranslate"><span class="pre">execute_inversion_2c()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inversion.inversion_1c"><code class="docutils literal notranslate"><span class="pre">inversion_1c()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inversion.inversion_2c"><code class="docutils literal notranslate"><span class="pre">inversion_2c()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inversion.inversion_mc"><code class="docutils literal notranslate"><span class="pre">inversion_mc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inversion.scatter_data"><code class="docutils literal notranslate"><span class="pre">scatter_data()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inversion.scatter_data_mc"><code class="docutils literal notranslate"><span class="pre">scatter_data_mc()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#main-py">main.py</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#main.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-py">model.py</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model.read_model"><code class="docutils literal notranslate"><span class="pre">read_model()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#misc-py">misc.py</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#misc.create_task_folder_list"><code class="docutils literal notranslate"><span class="pre">create_task_folder_list()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#misc.initial"><code class="docutils literal notranslate"><span class="pre">initial()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#misc.x_y_add_zeros"><code class="docutils literal notranslate"><span class="pre">x_y_add_zeros()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#obs-py">obs.py</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#obs.read_profile"><code class="docutils literal notranslate"><span class="pre">read_profile()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#obs.write_psf"><code class="docutils literal notranslate"><span class="pre">write_psf()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#profile-stk-py">profile_stk.py</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#profile_stk.read_profile"><code class="docutils literal notranslate"><span class="pre">read_profile()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="_sources/functions.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Mike.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.2.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>